---
title: 'warmXtrophic Project: CN Plots'
author: "Kara Dobson, Phoebe Zarnetske"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load in data
```{r, message = F}
# Clear all existing data
rm(list=ls())

#Load packages
library(tidyverse)
library(plotrix)

# Set working directory to Google Drive
setwd("/Volumes/GoogleDrive/Shared drives/SpaCE_Lab_warmXtrophic/data/")

# Read in data
cn <- read.csv("L1/CN/CN_L1.csv")

# Summary of data
with(cn,table(cn$site,cn$species)) 
with(cn,table(cn$year,cn$species)) 
with(cn,table(cn$year,cn$site)) 
```

# Carbon data: all yrs, sites
## Cest and Popr = UMBS, Soca = KBS (working on faceting this)
```{r}
ggplot(cn, aes(x = species, y = carbon, fill = state)) +
        #facet_grid(.~site) +
        geom_boxplot(color = "black", outlier.shape = NA) +
        labs(x = "Species", y = "Average Carbon Content") +
        scale_fill_manual(values = c("#a6bddb", "#fb6a4a")) +
        scale_x_discrete(labels=c("ambient" = "A", "warmed" = "W")) +
        geom_jitter(shape=16, position=position_jitterdodge(), alpha = 0.6, aes(colour = state)) +
        scale_color_manual(values = c("ambient" = "#a6bddb", "warmed" = "#fb6a4a")) +
        coord_cartesian(ylim = c(42, 53)) +
        theme_classic()
```

# Nitrogen data: all yrs, sites
```{r}
ggplot(cn, aes(x = species, y = nitrogen, fill = state)) +
        #facet_grid(.~site) +
        geom_boxplot(color = "black", outlier.shape = NA) +
        labs(x = "Species", y = "Average Nitrogen Content") +
        scale_fill_manual(values = c("#a6bddb", "#fb6a4a")) +
        scale_x_discrete(labels=c("ambient" = "A", "warmed" = "W")) +
        geom_jitter(shape=16, position=position_jitterdodge(), alpha = 0.6, aes(colour = state)) +
        scale_color_manual(values = c("ambient" = "#a6bddb", "warmed" = "#fb6a4a")) +
        theme_classic()
```

# Nitrogen data: all yrs, by species
```{r}
ggplot(cn, aes(x = factor(year), y = nitrogen, fill = state)) +
        geom_boxplot(color = "black", outlier.shape = NA) +
        geom_jitter(shape=16, position=position_jitterdodge(), alpha = 0.6, aes(colour = state)) +
        facet_grid(.~species) +
        labs(x = "Year", y = "Average Nitrogen Content") +
        scale_fill_manual(values = c("#a6bddb", "#fb6a4a")) +
        #scale_x_discrete(labels=c("ambient" = "A", "warmed" = "W")) +
        scale_color_manual(values = c("ambient" = "#a6bddb", "warmed" = "#fb6a4a")) +
        facet_grid(.~species) +
        theme_classic() +
        theme(axis.text.x = element_text(angle = 90))
```

# Carbon data: all yrs, by species
```{r}
ggplot(cn, aes(x = factor(year), y = carbon, fill = state)) +
        geom_boxplot(color = "black", outlier.shape = NA) +
        geom_jitter(shape=16, position=position_jitterdodge(), alpha = 0.6, aes(colour = state)) +
        facet_grid(.~species) +
        labs(x = "Year", y = "Average Carbon Content") +
        scale_fill_manual(values = c("#a6bddb", "#fb6a4a")) +
        #scale_x_discrete(labels=c("ambient" = "A", "warmed" = "W")) +
        scale_color_manual(values = c("ambient" = "#a6bddb", "warmed" = "#fb6a4a")) +
        facet_grid(.~species) +
        theme_classic() +
        theme(axis.text.x = element_text(angle = 90))
```

# Some major outlier for Popr carbon; omit and re-plot
```{r}
cn1<-cn[(cn$carbon < 70),]
cn1 <- cn1[!is.na(cn1$carbon), ] 
ggplot(cn1, aes(x = factor(year), y = carbon, fill = state)) +
        geom_boxplot(color = "black", outlier.shape = NA) +
        geom_jitter(shape=16, position=position_jitterdodge(), alpha = 0.6, aes(colour = state)) +
        facet_grid(.~species) +
        labs(x = "Year", y = "Average Carbon Content") +
        scale_fill_manual(values = c("#a6bddb", "#fb6a4a")) +
        #scale_x_discrete(labels=c("ambient" = "A", "warmed" = "W")) +
        scale_color_manual(values = c("ambient" = "#a6bddb", "warmed" = "#fb6a4a")) +
        facet_grid(.~species) +
        theme_classic() +
        theme(axis.text.x = element_text(angle = 90))
```
